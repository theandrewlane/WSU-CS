/*
 * Andrew Lane
 * CS2550
 * SQL Assignment #10
 * 11/22/15
*/

--1
INSERT INTO INSTRUCTOR(INSTRUCTOR_ID,SALUTATION ,FIRST_NAME ,LAST_NAME ,STREET_ADDRESS ,ZIP,PHONE ,CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
VALUES('815', 'Mr','Hugo','Reyes',' 2342 Oceanic Way','07002',NULL,'andrewlane',sysdate,'andrewlane',sysdate);

UPDATE ZIPCODE
SET CITY = 'Bayonne',
    STATE = 'NJ',
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate
WHERE ZIP ='07002';


--2
INSERT INTO SECTION(SECTION_ID,COURSE_NO ,SECTION_NO  ,START_DATE_TIME,LOCATION ,INSTRUCTOR_ID,CAPACITY ,CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
VALUES('48','142','4',TO_DATE('22-SEP-2011','DD-MON-YYYY'),'L211','815','15','andrewlane',sysdate,'andrewlane',sysdate);


--3
INSERT INTO ENROLLMENT(STUDENT_ID, SECTION_ID,ENROLL_DATE, FINAL_GRADE ,CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
VALUES('137','48',SYSDATE, NULL, 'andrewlane',sysdate,'andrewlane',sysdate);
INSERT INTO ENROLLMENT(STUDENT_ID, SECTION_ID,ENROLL_DATE, FINAL_GRADE ,CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
VALUES('375','48',SYSDATE, NULL, 'andrewlane',sysdate,'andrewlane',sysdate);
INSERT INTO ENROLLMENT(STUDENT_ID, SECTION_ID,ENROLL_DATE, FINAL_GRADE ,CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
VALUES('266','48',SYSDATE, NULL, 'andrewlane',sysdate,'andrewlane',sysdate);
INSERT INTO ENROLLMENT(STUDENT_ID, SECTION_ID,ENROLL_DATE, FINAL_GRADE ,CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
VALUES('382','48',SYSDATE, NULL, 'andrewlane',sysdate,'andrewlane',sysdate);


--4
DELETE FROM GRADE
WHERE STUDENT_ID = '147' AND SECTION_ID = '120';
DELETE FROM ENROLLMENT
WHERE STUDENT_ID = '147' AND SECTION_ID = '120';

--5
DELETE FROM GRADE
WHERE STUDENT_ID = '180' AND SECTION_ID = '119';
DELETE FROM ENROLLMENT
WHERE STUDENT_ID = '180' AND SECTION_ID = '119';

--6
UPDATE INSTRUCTOR
SET PHONE = '4815162342',
    SALUTATION  = 'Mr',
    FIRST_NAME = 'Hugo',
    LAST_NAME = 'Reyes',
    STREET_ADDRESS = '2342 Oceanic Way',
    ZIP = '07002'
WHERE INSTRUCTOR_ID ='815'
      AND PHONE IS NULL;

--7
UPDATE GRADE
SET NUMERIC_GRADE = '100',
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate,
    RESULT ='PASS'
WHERE GRADE_TYPE_CODE ='HM'
      AND GRADE_CODE_OCCURRENCE = 1
      AND SECTION_ID = '119'
      AND STUDENT_ID = '193';

UPDATE GRADE
SET NUMERIC_GRADE = '100',
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate,
    RESULT ='PASS'
WHERE GRADE_TYPE_CODE ='HM'
      AND GRADE_CODE_OCCURRENCE = 1
      AND SECTION_ID = '119'
      AND STUDENT_ID = '220';

UPDATE GRADE
SET NUMERIC_GRADE = '100',
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate,
    RESULT ='PASS'
WHERE GRADE_TYPE_CODE ='HM'
      AND GRADE_CODE_OCCURRENCE = 1
      AND SECTION_ID = '119'
      AND STUDENT_ID = '223';

--8
UPDATE GRADE
SET NUMERIC_GRADE = NUMERIC_GRADE * 1.10,
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate,
    RESULT ='PASS'
WHERE GRADE_TYPE_CODE ='FI'
      AND SECTION_ID = '119'   
      AND STUDENT_ID = '193'
      AND GRADE_CODE_OCCURRENCE = 1;

UPDATE GRADE
SET NUMERIC_GRADE = NUMERIC_GRADE * 1.10,
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate,
    RESULT ='PASS'
WHERE GRADE_TYPE_CODE ='FI'
      AND SECTION_ID = '119'   
      AND STUDENT_ID = '220'
      AND GRADE_CODE_OCCURRENCE = 1;

UPDATE GRADE
SET NUMERIC_GRADE = NUMERIC_GRADE * 1.10,
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate,
    RESULT ='PASS'
WHERE GRADE_TYPE_CODE ='FI'
      AND SECTION_ID = '119'   
      AND STUDENT_ID = '223'
      AND GRADE_CODE_OCCURRENCE = 1;

--9
INSERT INTO ENROLLMENT(STUDENT_ID,SECTION_ID,ENROLL_DATE, FINAL_GRADE, CREATED_BY ,CREATED_DATE ,MODIFIED_BY ,MODIFIED_DATE )
SELECT COURSE_NO ,SECTION_ID,sysdate,NULL,'andrewlane',sysdate,'andrewlane',sysdate
FROM SECTION
WHERE COURSE_NO = 142;

SELECT s.SECTION_ID, s.LOCATION,COUNT(STUDENT_ID) AS ENROLLED
FROM SECTION s, COURSE c, ENROLLMENT e
WHERE s.COURSE_NO = c.COURSE_NO 
AND s.SECTION_ID = e.SECTION_ID
AND c.DESCRIPTION = 'Project Management' 
GROUP BY s.SECTION_ID, s.LOCATION;


--10
UPDATE INSTRUCTOR 
SET FIRST_NAME ='Hugo',
    LAST_NAME ='Reyes',
    STREET_ADDRESS = '2342 Oceanic Way',
    ZIP = '07002',
    PHONE = '4815162342',
    CREATED_BY = 'andrewlane',
    CREATED_DATE = sysdate,
    MODIFIED_BY = 'andrewlane',
    MODIFIED_DATE = sysdate
WHERE INSTRUCTOR_ID = 815;

SELECT i.FIRST_NAME, i.LAST_NAME, i.PHONE
FROM INSTRUCTOR i, SECTION s , COURSE c
WHERE i.INSTRUCTOR_ID = s.INSTRUCTOR_ID
AND s.COURSE_NO = c.COURSE_NO
AND c.DESCRIPTION = 'Project Management'
ORDER BY i.FIRST_NAME;

--11
SELECT s.STUDENT_ID, s.FIRST_NAME,s.LAST_NAME, ROUND(AVG(NUMERIC_GRADE),2) AVERAGE
FROM GRADE g , STUDENT s
WHERE s.STUDENT_ID = g.STUDENT_ID
AND g.SECTION_ID = 119
GROUP BY s.STUDENT_ID, s.FIRST_NAME,s.LAST_NAME;


--12
SELECT NUMBEROFINSTRUCTORS
FROM
(SELECT COUNT(e.STUDENT_ID) AS STUDENTS, COUNT(i.INSTRUCTOR_ID) AS NUMBEROFINSTRUCTORS
FROM INSTRUCTOR i, SECTION s, ENROLLMENT e
WHERE i.INSTRUCTOR_ID = s.INSTRUCTOR_ID
AND s.SECTION_ID = e.SECTION_ID
AND s.LOCATION = 'L211'
GROUP BY s.SECTION_ID
HAVING COUNT(e.STUDENT_ID) > 3);


--13
SELECT DISTINCT i.SALUTATION ||' '||i.FIRST_NAME ||' '|| i.LAST_NAME AS INSTRUCTOR , i.PHONE
FROM INSTRUCTOR i ,SECTION s,COURSE c 
WHERE c.COURSE_NO = 142 AND c.DESCRIPTION = 'Project Management'
AND PHONE = '4815162342';

--14
SELECT s.FIRST_NAME, s.LAST_NAME ,c.SECTION_ID, c.COURSE_NO
FROM STUDENT s, ENROLLMENT e,SECTION c
WHERE s.STUDENT_ID = e.STUDENT_ID
AND e.SECTION_ID = c.SECTION_ID
AND e.FINAL_GRADE IS NULL
ORDER BY s.FIRST_NAME;

--15
SELECT STARTTIME, COUNT(COURSE_NO) AS NUMBER_OF_COURSES
FROM 
(SELECT DISTINCT TO_CHAR( START_DATE_TIME, 'HH:MI am') as STARTTIME, COURSE_NO
FROM SECTION)
GROUP BY STARTTIME
ORDER BY STARTTIME;

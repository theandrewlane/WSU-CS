/*
 * Andrew Lane
 * CS2550
 * SQL Assignment #4
 * 10/12/15
*/


--1
SELECT ROUND(AVG(COST),2) AS AVERAGE_COST
FROM COURSE;

--2
SELECT COUNT(REGISTRATION_DATE) AS January_Registrations
FROM STUDENT
WHERE REGISTRATION_DATE >= TO_DATE('01/01/07', 'MM/DD/YY')
AND REGISTRATION_DATE <= TO_DATE('01/31/07', 'MM/DD/YY');

--3
SELECT AVG(NUMERIC_GRADE) AS AVG_GRADE, MAX(NUMERIC_GRADE) AS HIGHEST_GRADE, MIN(NUMERIC_GRADE) AS LOWEST_GRADE
FROM GRADE
WHERE SECTION_ID=152;

--4
SELECT CITY, STATE, COUNT(ZIP) AS ZIPCODES
FROM ZIPCODE
GROUP BY CITY,STATE
HAVING COUNT(ZIP) > 3
ORDER BY STATE,CITY;

--5
SELECT SECTION_ID, COUNT(ENROLL_DATE) as STUDENTS_ENROLLED 
FROM ENROLLMENT 
WHERE ENROLL_DATE > TO_DATE('20-FEB-2007', 'DD-MON-YYYY') AND ENROLL_DATE < TO_DATE('22-FEB-2007', 'DD-MON-YYYY')
GROUP BY SECTION_ID, ENROLL_DATE 
ORDER BY STUDENTS_ENROLLED DESC;

--6
SELECT STUDENT_ID, SECTION_ID, ROUND(AVG(NUMERIC_GRADE),4) AS AVG_GRADE
FROM GRADE
WHERE SECTION_ID = '86'
GROUP BY STUDENT_ID,SECTION_ID
ORDER BY STUDENT_ID;

--7
SELECT STUDENT_ID, COUNT(SECTION_ID) AS SECTIONS_ENROLLED
FROM ENROLLMENT
WHERE STUDENT_ID = '250'
GROUP BY STUDENT_ID;

--8
SELECT SECTION_ID, MIN(NUMERIC_GRADE) AS LOWEST_QUIZ_SCORE
FROM GRADE
WHERE NUMERIC_GRADE >= 80
GROUP BY SECTION_ID
ORDER BY SECTION_ID;

--9
SELECT EMPLOYER ,COUNT(STUDENT_ID) AS STUDENT_EMPLOYEES
FROM STUDENT
GROUP BY EMPLOYER
HAVING COUNT(STUDENT_ID) > 5
ORDER BY STUDENT_EMPLOYEES ASC;

--10
SELECT SECTION_ID , COUNT(NUMERIC_GRADE) AS PARTICIPATION_GRADES, MIN(NUMERIC_GRADE) AS LOWEST_PARTICIPATION_GRADE
FROM GRADE
GROUP BY SECTION_ID
HAVING COUNT(NUMERIC_GRADE ) > 15 
ORDER BY SECTION_ID ASC;